# 线段树

## 引入

线段树是常用来维护**区间信息**的数据结构。

线段树可以在$O(logN)$的时间复杂度内实现单点修改、区间修改、区间查询（区间求和，求区间最大值，求区间最小值）等操作。

## 线段树

### 线段树的基本结构与建树

#### 过程

线段树将每个长度不为$1$的区间划分成左右两个区间递归求解，把整个线段划分为一个树形结构，通过合并左右两个区间信息来求得该区间得信息。这种数据结构可以方便的进行大部分的区间操作。

有个大小为$5$的数组$a=\{10,11,12,13,14\}$，要将其转化为线段树，有以下做法：设线段树的根节点编号为$1$，用数组$d$来保存线段树，$d_{i}$用来保存线段树上编号为$i$的节点的值（这里每个节点所维护的值就是这个节点所表示的区间总和）。

我们先给出这棵线段树的形态，如下图所示：

![alt text](image.png)

图中每个节点中用红色字体标明的区间，表示该节点管辖的$a$数组上的区间，如$d_{1}$所管辖的区间就是$[1,5]$，即$d_1$所保存的值是$a_1+a_2+a_3+a_4+a_5$，$d_1=60$，表示其和为$60$。

通过观察不难发现，$d_i$的左儿子节点就是$d_{2i}$，$d_i$的右二子节点就是$d_{2i+1}$。如果$d_i$表示的是区间$[s,t]$（即$d_i=a_s+a_{s+1}+...+a_{t}$）的话，那么$d_i$的左儿子节点表示的是区间$[s,\frac{s+t}{2}]$，$d_i$的右二子表示的是区间$[\frac{s+t}{2} + 1, t]$。


